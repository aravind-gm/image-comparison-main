<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuralVision AI | Image Similarity Engine</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Grotesk:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Particles Background -->
    <div class="particle-container">
        <canvas id="particleCanvas"></canvas>
    </div>

    <!-- Floating Orbs -->
    <div class="floating-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="orb orb-4"></div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        
        <!-- Header with Animated Logo -->
        <header class="hero-header">
            <div class="logo-container">
                <div class="neural-icon">
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="connection"></div>
                    <div class="connection connection-2"></div>
                    <div class="connection connection-3"></div>
                </div>
                <h1 class="main-title">
                    <span class="gradient-text">Neural</span><span class="highlight-text">Vision</span>
                    <span class="ai-badge">AI</span>
                </h1>
            </div>
            <p class="subtitle">Advanced Deep Learning Image Similarity Analysis</p>
            <div class="tech-specs">
                <span class="spec-item"><span class="dot"></span> MobileNetV2</span>
                <span class="spec-item"><span class="dot"></span> Cosine Similarity</span>
                <span class="spec-item"><span class="dot"></span> Real-time Processing</span>
            </div>
        </header>

        <!-- Upload Section -->
        <form id="uploadForm" class="upload-section">
            <div class="comparison-container">
                
                <!-- Left Image Card -->
                <div class="image-card image-card-left">
                    <div class="card-header">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                <path d="M21 15l-5-5L5 21"/>
                            </svg>
                        </div>
                        <h3>Source Image</h3>
                        <div class="status-indicator" id="status1">
                            <span class="pulse-dot"></span>
                            <span class="status-text">Awaiting Upload</span>
                        </div>
                    </div>
                    
                    <input type="file" id="image1" name="image1" accept="image/*" required>
                    <label for="image1" class="upload-zone" id="zone1">
                        <div class="upload-content">
                            <div class="upload-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                            </div>
                            <p class="upload-text">Drop image or click to browse</p>
                            <p class="upload-subtext">PNG, JPG up to 10MB</p>
                        </div>
                        <div class="preview-area" id="preview1"></div>
                    </label>
                    
                    <div class="card-footer">
                        <span class="file-name" id="fileName1">No file selected</span>
                    </div>
                </div>

                <!-- VS Separator with Animation -->
                <div class="vs-separator">
                    <div class="vs-circle">
                        <div class="vs-text">VS</div>
                        <div class="rotating-border"></div>
                    </div>
                    <div class="connection-line"></div>
                </div>

                <!-- Right Image Card -->
                <div class="image-card image-card-right">
                    <div class="card-header">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                <path d="M21 15l-5-5L5 21"/>
                            </svg>
                        </div>
                        <h3>Target Image</h3>
                        <div class="status-indicator" id="status2">
                            <span class="pulse-dot"></span>
                            <span class="status-text">Awaiting Upload</span>
                        </div>
                    </div>
                    
                    <input type="file" id="image2" name="image2" accept="image/*" required>
                    <label for="image2" class="upload-zone" id="zone2">
                        <div class="upload-content">
                            <div class="upload-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                            </div>
                            <p class="upload-text">Drop image or click to browse</p>
                            <p class="upload-subtext">PNG, JPG up to 10MB</p>
                        </div>
                        <div class="preview-area" id="preview2"></div>
                    </label>
                    
                    <div class="card-footer">
                        <span class="file-name" id="fileName2">No file selected</span>
                    </div>
                </div>
            </div>

            <!-- Analyze Button -->
            <button type="submit" id="CompareButton" class="analyze-button">
                <span class="button-content">
                    <span class="button-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="M21 21l-4.35-4.35"/>
                        </svg>
                    </span>
                    <span class="button-text">Analyze Similarity</span>
                    <span class="button-arrow">→</span>
                </span>
                <div class="button-glow"></div>
            </button>
        </form>

        <!-- Results Dashboard -->
        <div class="results-dashboard" id="resultsDashboard">
            <div class="dashboard-header">
                <h2>Analysis Results</h2>
                <div class="result-timestamp" id="timestamp"></div>
            </div>

            <div class="results-content" id="resultText">
                <div class="waiting-state">
                    <div class="pulse-ring"></div>
                    <p class="waiting-text">Upload both images and click Analyze to begin processing</p>
                </div>
            </div>

            <!-- Similarity Meter -->
            <div class="similarity-meter" id="similarityMeter" style="display: none;">
                <div class="meter-label">Similarity Score</div>
                <div class="meter-bar-container">
                    <div class="meter-bar" id="meterBar"></div>
                    <div class="meter-markers">
                        <span>0%</span>
                        <span>25%</span>
                        <span>50%</span>
                        <span>75%</span>
                        <span>100%</span>
                    </div>
                </div>
            </div>

            <!-- Technical Details -->
            <div class="tech-details" id="techDetails" style="display: none;">
                <div class="detail-item">
                    <span class="detail-label">Algorithm</span>
                    <span class="detail-value">Cosine Similarity</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Model</span>
                    <span class="detail-value">ResNet-50</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Vector Dimension</span>
                    <span class="detail-value">2048D</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Processing Time</span>
                    <span class="detail-value" id="processingTime">--</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <p class="footer-tech">Powered by PyTorch & Deep Learning</p>
                <div class="team-section">
                    <h4 class="team-title">Development Team</h4>
                    <div class="team-members">
                        <div class="team-member team-lead">
                            <span class="member-badge">Team Lead</span>
                            <span class="member-name">Aravind GM</span>
                        </div>
                        <div class="team-grid">
                            <span class="team-member">Farha Nazz</span>
                            <span class="team-member">Manayatha</span>
                            <span class="team-member">Rithick</span>
                            <span class="team-member">Pranav Jain</span>
                        </div>
                    </div>
                </div>
                <p class="footer-copyright">© 2025 NeuralVision AI | All Rights Reserved</p>
            </div>
        </footer>
    </div>

    <script>
        // Particle Animation
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];
        const particleCount = 80;

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2 + 1;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;

                if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(124, 58, 237, 0.6)';
                ctx.fill();
            }
        }

        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle());
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            particles.forEach((particle, i) => {
                particle.update();
                particle.draw();

                particles.slice(i + 1).forEach(otherParticle => {
                    const dx = particle.x - otherParticle.x;
                    const dy = particle.y - otherParticle.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < 120) {
                        ctx.beginPath();
                        ctx.strokeStyle = `rgba(124, 58, 237, ${0.2 * (1 - distance / 120)})`;
                        ctx.lineWidth = 0.5;
                        ctx.moveTo(particle.x, particle.y);
                        ctx.lineTo(otherParticle.x, otherParticle.y);
                        ctx.stroke();
                    }
                });
            });

            requestAnimationFrame(animateParticles);
        }

        animateParticles();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Image Upload Logic
        // Use deployed backend on Render (change to 'http://127.0.0.1:5000/api/compare' for local testing)
        const API_ENDPOINT = 'https://neuralvision-ai.onrender.com/api/compare';
        const form = document.getElementById('uploadForm');
        const image1Input = document.getElementById('image1');
        const image2Input = document.getElementById('image2');
        const resultText = document.getElementById('resultText');
        const compareButton = document.getElementById('CompareButton');
        const similarityMeter = document.getElementById('similarityMeter');
        const techDetails = document.getElementById('techDetails');

        function setupImagePreview(inputId, previewId, statusId, fileNameId, zoneId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
            const status = document.getElementById(statusId);
            const fileName = document.getElementById(fileNameId);
            const zone = document.getElementById(zoneId);

            // Drag and drop
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('drag-over');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                if (e.dataTransfer.files.length) {
                    input.files = e.dataTransfer.files;
                    input.dispatchEvent(new Event('change'));
                }
            });

            input.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                        preview.style.display = 'block';
                        zone.querySelector('.upload-content').style.display = 'none';
                        status.innerHTML = `<span class="pulse-dot active"></span><span class="status-text">Ready</span>`;
                        fileName.textContent = file.name;
                        zone.classList.add('has-image');
                    }
                    reader.readAsDataURL(file);
                } else {
                    preview.innerHTML = '';
                    preview.style.display = 'none';
                    zone.querySelector('.upload-content').style.display = 'flex';
                    status.innerHTML = `<span class="pulse-dot"></span><span class="status-text">Awaiting Upload</span>`;
                    fileName.textContent = 'No file selected';
                    zone.classList.remove('has-image');
                }
            });
        }

        setupImagePreview('image1', 'preview1', 'status1', 'fileName1', 'zone1');
        setupImagePreview('image2', 'preview2', 'status2', 'fileName2', 'zone2');

        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            const file1 = image1Input.files[0];
            const file2 = image2Input.files[0];

            if (!file1 || !file2) {
                resultText.innerHTML = `
                    <div class="error-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" y1="8" x2="12" y2="12"/>
                            <line x1="12" y1="16" x2="12.01" y2="16"/>
                        </svg>
                        <p>Please upload both images before analyzing</p>
                    </div>
                `;
                return;
            }

            const startTime = Date.now();

            resultText.innerHTML = `
                <div class="processing-state">
                    <div class="spinner"></div>
                    <p class="processing-text">Processing neural networks...</p>
                    <p class="processing-subtext">Extracting features and calculating similarity</p>
                </div>
            `;
            
            compareButton.disabled = true;
            compareButton.classList.add('loading');
            compareButton.querySelector('.button-text').textContent = 'Analyzing...';
            similarityMeter.style.display = 'none';
            techDetails.style.display = 'none';

            const formData = new FormData();
            formData.append('image1', file1);
            formData.append('image2', file2);

            try {
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                const processingTime = ((Date.now() - startTime) / 1000).toFixed(2);

                if (!response.ok || data.status !== 'success') {
                    resultText.innerHTML = `
                        <div class="error-state">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="15" y1="9" x2="9" y2="15"/>
                                <line x1="9" y1="9" x2="15" y2="15"/>
                            </svg>
                            <p>Analysis Failed</p>
                            <p class="error-message">${data.error || 'Unknown error occurred'}</p>
                        </div>
                    `;
                    return;
                }

                const rawScore = data.score;
                const percentage = (rawScore * 100).toFixed(2);
                
                let interpretation, colorClass;
                if (rawScore > 0.9) {
                    interpretation = 'Nearly Identical';
                    colorClass = 'score-excellent';
                } else if (rawScore > 0.75) {
                    interpretation = 'Very Similar';
                    colorClass = 'score-good';
                } else if (rawScore > 0.5) {
                    interpretation = 'Moderately Similar';
                    colorClass = 'score-medium';
                } else if (rawScore > 0.3) {
                    interpretation = 'Somewhat Similar';
                    colorClass = 'score-low';
                } else {
                    interpretation = 'Very Different';
                    colorClass = 'score-poor';
                }

                resultText.innerHTML = `
                    <div class="success-state">
                        <div class="score-display ${colorClass}">
                            <div class="score-value">${(rawScore * 100).toFixed(1)}%</div>
                            <div class="score-raw">${rawScore.toFixed(6)}</div>
                        </div>
                        <div class="score-interpretation">
                            <span class="interpretation-badge ${colorClass}">${interpretation}</span>
                        </div>
                        <div class="score-description">
                            The images show <strong>${percentage}%</strong> similarity based on deep learning feature extraction
                        </div>
                    </div>
                `;

                // Update similarity meter
                similarityMeter.style.display = 'block';
                const meterBar = document.getElementById('meterBar');
                setTimeout(() => {
                    meterBar.style.width = `${percentage}%`;
                    meterBar.className = `meter-bar ${colorClass}`;
                }, 100);

                // Update technical details
                techDetails.style.display = 'grid';
                document.getElementById('processingTime').textContent = `${processingTime}s`;
                document.getElementById('timestamp').textContent = `Completed at ${new Date().toLocaleTimeString()}`;

            } catch (error) {
                console.error('Fetch error:', error);
                resultText.innerHTML = `
                    <div class="error-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" y1="9" x2="12" y2="13"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                        <p>Connection Error</p>
                        <p class="error-message">Unable to reach Flask API. Ensure server is running on port 5000</p>
                    </div>
                `;
            } finally {
                compareButton.disabled = false;
                compareButton.classList.remove('loading');
                compareButton.querySelector('.button-text').textContent = 'Analyze Similarity';
            }
        });
    </script>
</body>
</html>